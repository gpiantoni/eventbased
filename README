A pipeline of MATLAB functions to run Fieldtrip for EEG/MEG analysis


-----------------------------------------------------------
MAIN FUNCTIONS
-----------------------------
PREPROCESSING
- SELDATA: get data from recordings and put them in subject directory
- GCLEAN: use German's toolbox to clean the data
- REDEF: redefine trials
-----------------------------

-----------------------------
ANALYSIS
- ERP_SUBJ: create subject-specific erp


-----------------------------
-----------------------------------------------------------

-----------------------------------------------------------
SUBFUNCTIONS
- LOAD_DATA: load data, and optionally get bad channels
  ERP_SUBJ,

- LOAD_SOURCE: load source data from virtual electrode
  ERP_SUBJ, 
  




-----------------------------------------------------------

-----------------------------------------------------------
INFO
.data: path of /data1/projects/PROJ/subjects/
  SELDATA, GCLEAN, REDEF, LOAD_DATA, 

.derp: directory with ERP data
  ERP_SUBJ, 

.dsou: directory with SOURCE data
  LOAD_SOURCE

.log: name of the file and directory to save log
  SELDATA, GCLEAN, REDEF, ERP_SUBJ, 

.mod: modality, MOD in /data1/projects/PROJ/subjects/SUBJ/MOD/NICK/
  SELDATA, GCLEAN, REDEF, LOAD_DATA, 

.nick: NICK in /data1/projects/PROJ/subjects/SUBJ/MOD/NICK/
  SELDATA, GCLEAN, REDEF, LOAD_DATA, 

.qlog: directory with output of SGE
  SELDATA, 

.rec: REC in /data1/projects/PROJ/recordings/REC/
  LOAD_DATA, 

.recs: path of /data1/projects/PROJ/recordings/REC/subjects/
  SELDATA, 

.sens.file: file with EEG sensors. It can be sfp or mat. It's included in data struct. If empty, it does not read the sensors.
  SELDATA, GCLEAN,

.sens.dist: distance between sensors to consider them neighbors (in the units of cfg.sens.file)
  GCLEAN,

-----------------------------------------------------------
CFG.OPT


.bad_samples.MADs = 5;
  GCLEAN,

.bad_channels.MADs = 8;
  GCLEAN,

.bad_samples.Percentile = [25 75];
  GCLEAN,

.cond: cell with conditions (e.g. {'*cond1' '*cond2'})'
  ERP_SUBJ,
 
.csd.method: method to do scalp current density ('finite' or 'spline' or 'hjorth')
  REDEF,

.eog.correction = 50;
  GCLEAN,

.emg.correction = 30;
  GCLEAN,

.erp: a structure with cfg to pass to ft_timelockanalysis
  ERP_SUBJ,

.event2trl: function name in NICK_private which creates the correct trl based on events
  REDEF,

.fsample: manually specify the frequency (very easily bug-prone, but in this way it does not read "data" all the time)
  GCLEAN,

.label: if not empty, labels of electrodes to rename (same length as seldata.selchan) 
  SELDATA, 

.lpfreqn = [.3 / (cfg.gclean.fsample/2)]; % normalized by half of the sampling frequency!
  GCLEAN,

.preproc1: struct to pass to ft_preprocessing before cutting trials (if empty, no preprocessing)
  REDEF,

.preproc2: struct to pass to ft_preprocessing after cutting trials (if empty, no preprocessing)
  REDEF,

.pwl.pca: if not empty, number of PC to work with in JADE
  GCLEAN,

.rcnd: specific name of the condition of interest in the raw recording folder
  SELDATA, 
  
.redef: options to pass to event2trl 
  REDEF, 

.saveall: false
  GCLEAN,

.selchan: channels to read. It can be a vector or a cell of strings with the elec names on file (Micromed elec names are '  1' '  2'  '  3') 
  SELDATA, 

.source: read virtual electrode data (logical)
  ERP_SUBJ,

.trialfun: name of the trialfun used to read the data, see below. The function should be in NICK_private/ 
  SELDATA, 

.verbose: true
  GCLEAN,

REDEF, 

-----------------------------------------------------------

 
 
